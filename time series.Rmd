---
title: "Time Series Analysis in R"
author: "Andi"
Last updated: "`r format(Sys.time(), '%d %B, %Y')`"
output: 
  html_document: 
    keep_md: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
# {r, echo = FALSE, results='hide'}
# if we used both 'echo=TRUE' and 'results=hide' the pipe would not work properly
# if we used 'echo = FALSE' and 'results=hide' we would have only messages (i.e. attaching package) If we don't want them we set 'error = FALSE', 'warning = FALSE', and 'message = FALSE'.
library(dplyr)
```

## Exploring raw time series

```{r}
Nile<-structure(c(1120, 1160, 963, 1210, 1160, 1160, 813, 1230, 1370, 
1140, 995, 935, 1110, 994, 1020, 960, 1180, 799, 958, 1140, 1100, 
1210, 1150, 1250, 1260, 1220, 1030, 1100, 774, 840, 874, 694, 
940, 833, 701, 916, 692, 1020, 1050, 969, 831, 726, 456, 824, 
702, 1120, 1100, 832, 764, 821, 768, 845, 864, 862, 698, 845, 
744, 796, 1040, 759, 781, 865, 845, 944, 984, 897, 822, 1010, 
771, 676, 649, 846, 812, 742, 801, 1040, 860, 874, 848, 890, 
744, 749, 838, 1050, 918, 986, 797, 923, 975, 815, 1020, 906, 
901, 1170, 912, 746, 919, 718, 714, 740), .Tsp = c(1871, 1970, 
1), class = "ts")

# Print the Nile dataset
print(Nile)

# List the number of observations in the Nile dataset
length(Nile)

# Display the first 10 elements of the Nile dataset
head(Nile, 10)

# Display the last 12 elements of the Nile dataset
tail(Nile, 12)
```

## Basic time series plots

```{r}
# Plot the Nile data
plot(Nile)

# Plot the Nile data with xlab and ylab arguments
plot(Nile, xlab = "Year", ylab = "River Volume (1e9 m^{3})")

# Plot the Nile data with xlab, ylab, main, and type arguments
plot(Nile, xlab = "Year", ylab = "River Volume (1e9 m^{3})", main = "Annual River Nile Volume at Aswan, 1871-1970", type = "b")
```

## What does the time index tell us?

```{r, echo=FALSE}
discrete_data <- structure(c(0.479425538604203, 0.841470984807897, 0.997494986604054, 
0.909297426825682, 0.598472144103957, 0.141120008059867, -0.35078322768962, 
-0.756802495307928, -0.977530117665097, -0.958924274663138, -0.705540325570392, 
-0.279415498198926, 0.215119988087816, 0.656986598718789, 0.937999976774739, 
0.989358246623382, 0.79848711262349, 0.412118485241757, -0.0751511204618093, 
-0.54402111088937), .Tsp = c(1, 20, 1), class = "ts")

continuous_series <- c(0.568894675391674, 0.766304082748762, 0.992075122074743, 0.974817414246897, 
0.399123202687807, 0.37660246288782, -0.385320332818421, -0.836358518142533, 
-0.999669829045622, -0.998310189536195, -0.646222799842192, -0.0938615130061447, 
0.400529093874378, 0.681605778899236, 0.953181592214187, 0.996938027205692, 
0.839341938468838, 0.370037544609373, -0.255096756784655, -0.617439825310109
)

continuous_time_index <- c(1.21032244665548, 1.74613730167039, 2.88963444461115, 3.59138367255218, 
5.46206454467028, 5.51093333004974, 7.0742951775901, 8.26439798949286, 
9.37338230921887, 9.5410633541178, 11.1611216005404, 12.378370850347, 
13.3905590295326, 14.0662804655731, 15.0935473444406, 15.8645145166665, 
16.8574128514156, 18.0914570542518, 19.3654514602385, 20.1805236600339
)
```

```{r}
# Plot the continuous_series using continuous time indexing
par(mfrow=c(2,1))
plot(continuous_time_index,continuous_series, type = "b")

# Make a discrete time index using 1:20 
discrete_time_index <- seq(1:20)

# Now plot the continuous_series using discrete time indexing
plot(discrete_time_index,continuous_series, type = "b")

```

## Sampling frequency

```{r, echo=FALSE}
AirPassengers<-structure(c(112, 118, 132, 129, 121, 135, 148, 148, 136, 119, 
104, 118, 115, 126, 141, 135, 125, 149, 170, 170, 158, 133, 114, 
140, 145, 150, 178, 163, 172, 178, 199, 199, 184, 162, 146, 166, 
171, 180, 193, 181, 183, 218, 230, 242, 209, 191, 172, 194, 196, 
196, 236, 235, 229, 243, 264, 272, 237, 211, 180, 201, 204, 188, 
235, 227, 234, 264, 302, 293, 259, 229, 203, 229, 242, 233, 267, 
269, 270, 315, 364, 347, 312, 274, 237, 278, 284, 277, 317, 313, 
318, 374, 413, 405, 355, 306, 271, 306, 315, 301, 356, 348, 355, 
422, 465, 467, 404, 347, 305, 336, 340, 318, 362, 348, 363, 435, 
491, 505, 404, 359, 310, 337, 360, 342, 406, 396, 420, 472, 548, 
559, 463, 407, 362, 405, 417, 391, 419, 461, 472, 535, 622, 606, 
508, 461, 390, 432), .Tsp = c(1949, 1960.91666666667, 12), class = "ts")
```

```{r}
# Plot AirPassengers
plot(AirPassengers)

# View the start and end dates of AirPassengers
start(AirPassengers)
end(AirPassengers)

# Use time(), deltat(), frequency(), and cycle() with AirPassengers 
time(AirPassengers)
deltat(AirPassengers)
frequency(AirPassengers)
cycle(AirPassengers)
```

## Missing values

Still working with the AirPassengers data, but now there are missing values.

```{r, echo=FALSE}
AirPassengers <- structure(c(112, 118, 132, 129, 121, 135, 148, 148, 136, 119, 
104, 118, 115, 126, 141, 135, 125, 149, 170, 170, 158, 133, 114, 
140, 145, 150, 178, 163, 172, 178, 199, 199, 184, 162, 146, 166, 
171, 180, 193, 181, 183, 218, 230, 242, 209, 191, 172, 194, 196, 
196, 236, 235, 229, 243, 264, 272, 237, 211, 180, 201, 204, 188, 
235, 227, 234, 264, 302, 293, 259, 229, 203, 229, 242, 233, 267, 
269, 270, 315, 364, 347, 312, 274, 237, 278, NA, NA, NA, NA, 
NA, NA, NA, NA, NA, NA, NA, NA, 315, 301, 356, 348, 355, 422, 
465, 467, 404, 347, 305, 336, 340, 318, 362, 348, 363, 435, 491, 
505, 404, 359, 310, 337, 360, 342, 406, 396, 420, 472, 548, 559, 
463, 407, 362, 405, 417, 391, 419, 461, 472, 535, 622, 606, 508, 
461, 390, 432), .Tsp = c(1949, 1960.91666666667, 12), class = "ts")
```

```{r}
# Plot the AirPassengers data
plot(AirPassengers)

# Compute the mean of AirPassengers
mean(AirPassengers, na.rm = TRUE)

# Impute mean values to NA in AirPassengers
AirPassengers[85:96] <- mean(AirPassengers, na.rm = TRUE)

# Generate another plot of AirPassengers
plot(AirPassengers)

# Add the complete AirPassengers data to your plot
rm(AirPassengers)
points(AirPassengers, type = "l", col = 2, lty = 3)
```

## Basic time series objects

```{r, echo=FALSE}
data_vector <- c(2.05219410731111, 4.29288527974091, 3.32941329441844, 3.50859506696045, 
0.000957693762193124, 1.92171863450249, 0.797813412800535, 0.299954343478063, 
0.943568753562609, 0.574828338758714, -0.00340059028674611, 0.34486491757086, 
2.22297611360904, 0.1763144576315, 2.70976227698024, 1.25019489653419, 
-0.400716475448651, 0.88527321208965, -1.5852420265539, -2.28292788910447, 
-2.56095312898444, -3.12599637544793, -2.86602958954692, -1.78470092068662, 
-1.88949129078692, -2.7255351193826, -2.10331418003627, -0.0174256893338487, 
-0.361320415116881, -2.90084033266105, -3.28474409267047, -2.8684594717709, 
-1.95050744365674, -4.88018925247303, -3.2634605352894, -1.63960625222554, 
-3.30125758402894, -2.63312454334943, -1.70583540221139, -2.21198250613255, 
-0.517059518572955, 0.0752508094841423, -0.840699471563585, -1.40226834874561, 
-0.138211423023857, -1.40659547028281, -2.3046941054804, 1.50738914324565, 
0.711867947688864, -1.13005190223045)
```

```{r}
# Use print() and plot() to view data_vector
print(data_vector)
plot(data_vector)

# Convert data_vector to a ts object with start = 2004 and frequency = 4
time_series <- ts(data_vector, start = 2004, frequency = 4)

# Use print() and plot() to view time_series
print(time_series)
plot(time_series) 
```

## Testing whether an object is a time series

```{r}
# Check whether Nile is a ts object
is.ts(Nile)
```

## Plotting a time series object

```{r}
eu_stocks <- EuStockMarkets

# Check whether eu_stocks is a ts object
is.ts(eu_stocks)

# View the start, end, and frequency of eu_stocks
start(eu_stocks)
end(eu_stocks)
frequency(eu_stocks)

# Generate a simple plot of eu_stocks
plot(eu_stocks)

# Use ts.plot with eu_stocks
ts.plot(eu_stocks, col = 1:4, xlab = "Year", ylab = "Index Value", main = "Major European Stock Indices, 1991-1998")

# Add a legend to your ts.plot
legend("topleft", colnames(eu_stocks), lty = 1, col = 1:4, bty = "n")
```

## Removing trends in variability via the logarithmic transformation

```{r, echo=FALSE}
rapid_growth <- c(505.954737316542, 447.35560816695, 542.583090477044, 516.063361274983, 
506.959924087797, 535.016232606015, 496.929129437996, 497.562555328502, 
577.248300530956, 536.855967325257, 541.245940412262, 473.497840289097, 
550.988961460551, 569.410637437069, 522.915183368473, 487.200195130919, 
594.610786395524, 591.173975668723, 615.986775394564, 621.317545120693, 
607.125046916761, 587.036701378981, 554.155438462285, 644.117241827027, 
509.700025728118, 607.094339401359, 603.55118553444, 613.621586650076, 
544.914334775047, 670.811820766561, 687.13161588209, 615.581708859918, 
711.187318608945, 694.297903386338, 681.929344495129, 659.140256189321, 
642.702057830158, 601.530062712521, 666.762307473106, 650.965683100529, 
606.091343627865, 696.678827373702, 641.602509472816, 855.771919797152, 
667.329074652784, 573.491390192462, 791.733265065015, 751.591446783947, 
610.794814080548, 624.65033623201, 833.298991700858, 639.886724484288, 
736.828256803519, 772.292341071224, 686.886519321095, 667.763083378498, 
712.94149525726, 918.183828402689, 656.108907724902, 700.497201964217, 
683.493272462585, 781.737968201983, 715.684280499056, 808.287549436184, 
820.779546770362, 656.885589359776, 733.339974340827, 773.538730437607, 
641.202740082118, 932.21185739678, 680.676565427109, 988.282815285029, 
664.898568280288, 813.528318290545, 883.408798971726, 924.274924691176, 
969.43211824107, 777.329346514109, 880.998409919801, 971.358289510766, 
902.958423571348, 1020.74565895517, 1075.14831710597, 886.170748719307, 
889.632200892515, 950.390776999556, 878.039522146964, 1043.76763270868, 
901.108966040025, 1079.65840856798, 933.905398508361, 921.9433013918, 
870.807113616954, 811.139766624589, 1004.26766243592, 1008.17582581146, 
1189.48933735193, 751.970606760973, 947.475252330288, 886.515305193286, 
1074.89426408969, 1101.1306720708, 1130.1854576199, 975.849507265787, 
948.161009999662, 1177.8226568287, 1227.12713297946, 976.995711035094, 
836.708871866655, 1323.60473389093, 852.35320730904, 1200.82615703738, 
1274.47884753083, 1349.2613900482, 1102.63337196778, 1324.85659429696, 
1268.71865481688, 1058.22892886463, 1204.08723498947, 1084.65028499166, 
1284.43050935569, 1195.28425174124, 1058.42621256846, 1188.0576623439, 
1166.59336076, 1064.69458969538, 1429.06852442551, 1070.85280871704, 
1539.33053352377, 1467.15710870044, 1127.70582024314, 1296.0717171226, 
1555.27412822535, 1332.90372372162, 1315.4236396165, 1189.2461691901, 
1482.43394167998, 1240.92868932515, 1237.77196935431, 1468.60833835437, 
1328.54569942606, 1589.50783787689, 1373.16295850591, 1503.55627838567, 
1659.93756371734, 1704.6136574176, 1550.46378217986, 1625.80261162794, 
1873.85823632632, 1370.62086282574, 1439.71135339554, 1447.43691659102, 
1579.91576345679, 1681.2571135903, 1661.60589978392, 1311.84684158442, 
1326.03084218461, 1323.09951189813, 1550.48631755657, 1606.20420490403, 
1768.54014627508, 1509.8367966576, 1592.10861892944, 1627.61875806856, 
1544.63289803997, 1439.52343145633, 1682.35177380745, 1850.70970808186, 
1673.38009271644, 1832.42716167314, 1672.26717594592, 1781.57683020519, 
1659.28985001442, 1970.03886201406, 2044.7123676587, 1929.09019953541, 
1891.7042228956, 1487.15774065956, 2013.8721752695, 1796.78863307401, 
1977.01825843918, 1516.95521151591, 1650.6039164404, 1523.28339404562, 
1696.6181065012, 1627.26087609279, 1787.29683278825, 1567.28735420676, 
1881.99627254267, 2318.98327490681, 1941.98786180548, 1820.27972976969, 
2154.81229145692, 2261.54706560833, 2052.22139601365, 2079.17104479186, 
2010.06086639259, 2145.26059886687, 1775.30080127631, 2013.40704947701
)
```

```{r}
# Log rapid_growth
linear_growth <-log(rapid_growth)
  
# Plot linear_growth using ts.plot()
ts.plot(linear_growth)
```

## Removing trends in level by differencing

```{r, echo=FALSE}
z <- c(6.22644721334281, 6.10335382233382, 6.29634123585615, 6.24622955111167, 
6.22843195527522, 6.28229708775537, 6.20844741922452, 6.20972128804789, 
6.35827250415224, 6.28572984126078, 6.29387377889552, 6.16014735145226, 
6.31171477530532, 6.34460185650482, 6.25941927762177, 6.18867511691063, 
6.38790705099065, 6.38211034916024, 6.42322549478775, 6.4318422960411, 
6.40873477794284, 6.37508734151749, 6.31744522223519, 6.46788076206124, 
6.23382236782298, 6.40868419809582, 6.40283085141402, 6.41937842976356, 
6.30062859840956, 6.50848865168789, 6.53252585448752, 6.4225676888201, 
6.56693585306342, 6.54290112400289, 6.52492605202954, 6.49093634370728, 
6.46568125422392, 6.39947651373773, 6.50243362179406, 6.47845692668784, 
6.40703070676956, 6.54632451169874, 6.46396896781775, 6.75200389180284, 
6.50328328954751, 6.35174292371473, 6.67422454855503, 6.62219288746384, 
6.41476108293605, 6.43719203115034, 6.72539251138006, 6.46129116769531, 
6.60235483491626, 6.64936315848762, 6.53216909563942, 6.50393344502688, 
6.56939936271001, 6.82239761937805, 6.48632679303797, 6.55179037142821, 
6.52721681333954, 6.66151960536819, 6.57323912069037, 6.69491787322661, 
6.71025455545394, 6.4875098623154, 6.5976094065566, 6.65097574043069, 
6.46334569409202, 6.83756010365691, 6.52308725269382, 6.89596890707456, 
6.49963450012032, 6.70138073649028, 6.78378805946117, 6.82900956493073, 
6.87671045494522, 6.65586412994792, 6.78105582107621, 6.87869539045853, 
6.80567650980035, 6.9282886773914, 6.98021390044576, 6.78690965068204, 
6.79080811988766, 6.85687324422581, 6.77769160645684, 6.95059216963548, 
6.80362618929694, 6.98439998172557, 6.83937514670541, 6.82648372642902, 
6.76942049838646, 6.69844037789147, 6.91201386077297, 6.91589786378861, 
7.081279365728, 6.62269723643191, 6.85380081770285, 6.78729839010667, 
6.97997757673786, 7.00409281457646, 7.0301370200274, 6.88330838114885, 
6.85452432960534, 7.07142280689253, 7.11243105220367, 6.88448226209977, 
6.72947618664758, 7.1881141525679, 6.74800100349129, 7.09076506309115, 
7.15029262699804, 7.20731260322573, 7.00545657231082, 7.18905950184368, 
7.14576273692186, 6.96435196790078, 7.09347707755427, 6.98901289603892, 
7.15807071571375, 7.0861393036455, 6.96453837871522, 7.08007503607121, 
7.06184312320099, 6.970443266778, 7.26477812949222, 6.97621062749874, 
7.33910288239914, 7.29108186763736, 7.02794060038759, 7.16709321266713, 
7.3494070973242, 7.19511509230523, 7.18191405213385, 7.08107491410905, 
7.30144057114722, 7.12361532128538, 7.12106824351186, 7.29207052275869, 
7.19184016387511, 7.37117971137166, 7.22487208663911, 7.31558843331146, 
7.41453526842476, 7.44109377015137, 7.34630937946721, 7.39375688767601, 
7.5357548122989, 7.2230191007094, 7.27219792344658, 7.27754962755863, 
7.3651268103319, 7.42729707447298, 7.41553982321997, 7.17919122609255, 
7.18994543004138, 7.18773237814052, 7.34632391396533, 7.38162903767151, 
7.47790970913714, 7.31975684228401, 7.37281459204766, 7.39487334104795, 
7.34254155465234, 7.27206738741634, 7.42794795886081, 7.52332447049693, 
7.42260086748169, 7.51339668490706, 7.42193557510494, 7.48525411080987, 
7.41414498862142, 7.58580854844815, 7.62301240707291, 7.56480377155094, 
7.54523340699751, 7.30462202063205, 7.60781460317569, 7.4937562577587, 
7.58934505855497, 7.32446045453292, 7.4088965098932, 7.32862341178055, 
7.4363921995442, 7.39465343615595, 7.48845960812977, 7.35710160410629, 
7.5400883395603, 7.74888412502893, 7.5714673984741, 7.50674546593622, 
7.67545889501181, 7.72380440037869, 7.62667809326483, 7.63972455710096, 
7.605920282382, 7.67101631529587, 7.48172515305964, 7.60758361556912
)
```

```{r}
# Generate the first difference of z
dz <- diff(z)
  
# Plot dz
ts.plot(dz)

# View the length of z and dz, respectively
length(z)
length(dz)
```

## Removing seasonal trends with seasonal differencing

```{r,echo=FALSE}
x <- c(-4.19803335973822, 9.56900905050747, 5.17514338906622, -9.69164636184119, 
-3.21529357476552, 10.8436693062559, 6.45215865708188, -10.8335590731441, 
-2.23535073514566, 10.119832962947, 6.57964573528545, -8.65656473226148, 
-2.51500138847406, 9.83743416797243, 7.38619432726046, -8.24350355631342, 
-4.26403257072438, 8.89886143008727, 8.54433581556254, -8.06691284107053, 
-4.02302530566536, 9.82267856454484, 7.77285238609707, -6.58777686807675, 
-3.45917112006633, 10.6138505016733, 7.37445047382904, -5.79871450522201, 
-1.20471055826558, 11.4292358845515, 7.57004694873634, -4.96838375977415, 
-2.00378659668805, 11.9413482982078, 9.40667210265289, -4.39658482425492, 
-1.55557889273259, 12.5998771289623, 8.50291637845889, -3.72896826710606, 
-2.82700000921691, 13.3759812867942, 8.12894114749321, -3.14924907770406, 
-2.79947272334396, 13.7105701226795, 6.75521688156725, -3.77974417787649, 
-3.76827394084617, 13.6253358560593, 6.53793056349892, -3.24909834265677, 
-5.02419102826334, 13.3553731337997, 6.93116080641335, -3.52735350362993, 
-5.19732896878058, 11.5797913233393, 7.16244857247412, -1.89460681643879, 
-5.77779700690048, 12.4826952884178, 6.20808841277938, -3.43403797043816, 
-7.08072100968159, 11.4136557746633, 6.74199013667799, -3.53237586423137, 
-8.39354230059932, 12.5072611286297, 6.47317547164243, -3.74524618197473, 
-9.42620870823793, 12.3808170457897, 8.04824272204917, -2.83152774381656, 
-7.30189285880787, 12.7658383061004, 8.22369850629786, -4.44813067987144, 
-6.96355759602497, 12.0340049862918, 7.57492470964176, -5.40221818593254, 
-6.56819814480662, 10.8964815061608, 7.27657057973042, -4.03787337902209, 
-6.72301328397502, 12.1808149692035, 8.28516213832065, -4.15934247966369, 
-6.36067044646075, 12.7530177649457, 8.66591165178255, -5.44053784032607, 
-4.87493170537183, 12.6001974041011, 8.16258920594197, -6.53957167229621
)
```

```{r}
# Generate a diff of x with lag = 4. Save this to dx
dx <- diff(x, lag = 4)
  
# Plot dx
ts.plot(dx)  

# View the length of x and dx, respectively 
length(x)
length(dx)

# observe
head(x, 8)
head(dx, 8)
```

## Simulate the white noise model

An ARIMA(p, d, q) model has three parts: 

- p: the autoregressive order, 

- d: the order of integration (or differencing) 

- q: the moving average order

```{r}
# Simulate a WN model with list(order = c(0, 0, 0))
white_noise <- arima.sim(model = list(order = c(0, 0, 0)), n = 100)

# Plot your white_noise data
ts.plot(white_noise)

# Simulate from the WN model with: mean = 100, sd = 10
white_noise_2 <- arima.sim(model = list(order = c(0, 0, 0)), n = 100, mean = 100, sd = 10)

# Plot your white_noise_2 data
ts.plot(white_noise_2)
```

## Estimate the white noise model

```{r,echo=FALSE}
y <- structure(c(109.761335203807, 98.3161015661823, 100.63294691568, 
88.7433987127593, 101.872377016961, 104.628357308022, 96.6446185677499, 
102.861935537741, 112.762472095071, 82.2321895604405, 88.9443425162465, 
94.603184959066, 105.611134283638, 113.827759889612, 104.823186799211, 
101.296287605209, 82.9845883499902, 88.9605839815819, 100.600456607996, 
91.035249256563, 100.1928594042, 95.3253727241077, 94.5864315510523, 
121.358295918349, 87.3787382991481, 96.8900652561591, 90.5130974518601, 
99.9084292221271, 102.569341770317, 104.961440623652, 104.734635474905, 
88.0046450549299, 100.779432761891, 121.647764133843, 85.7708319146464, 
79.1542817751461, 98.1884698770029, 99.9000575918412, 98.9108408854003, 
101.644224781541, 102.795262786231, 84.6511153287627, 96.478695879623, 
105.815471102771, 98.5186873070791, 105.24366218935, 109.612642086809, 
85.1420130618153, 82.8144174251857, 103.036291436483, 93.5696735465724, 
98.0892223944794, 81.2546061795588, 109.185538293753, 80.4318090604482, 
103.559532399435, 80.2226855501286, 84.9747654707037, 107.783629803383, 
92.612875815647, 99.8029344059519, 107.250849637866, 98.6637847611836, 
91.9227453154993, 98.3264180218282, 112.734017659718, 96.0281067924588, 
92.6490908853105, 83.0848439102975, 97.2219648542801, 106.613612756687, 
97.3694287042478, 108.784654442207, 104.918584253723, 84.4434297475219, 
85.6078609998276, 96.5152905606852, 94.1810528014953, 85.0285128829162, 
63.2662175136146, 87.2213673144322, 103.522954295167, 105.602155542432, 
103.260391527392, 101.115192549417, 108.456965675889, 97.676314341323, 
103.010808274931, 100.617555510141, 105.581077298303, 98.7272241180465, 
98.4399563595089, 90.7821910344929, 92.7459923258825, 102.937624393826, 
83.9530591640689, 110.159366234931, 104.175781699309, 99.2787550528578, 
103.251148823917), .Tsp = c(1, 100, 1), class = "ts")

ts.plot(y)
```

```{r}
# Fit the WN model to y using the arima command
arima(y, order = c(0, 0, 0))

# Calculate the sample mean and sample variance of y and compare with the previous output
mean(y)
var(y)

# The means are identical, the variances are close.
```

## The random walk (RW) model

$$
Y_t = Y_{t-1} + \epsilon_t,
$$
where $\epsilon_t$ is mean zero white noise.

- has only one parameter $\sigma_{\epsilon}^2$

- Simulation requires an initial point $Y_0$.

## Random walk with drift

$$
Y_t = c + Y_{t-1} + \epsilon_t,
$$
where $\epsilon_t$ is mean zero white noise.

- has two parameters, drift constant $c$ and $\sigma_{\epsilon}^2$

## Simulate the random walk model

```{r}
# Generate a RW model using arima.sim
random_walk <- arima.sim(model = list(order = c(0, 1, 0)), n = 100)

# Plot random_walk
ts.plot(random_walk)

# Calculate the first difference series
random_walk_diff <- diff(random_walk)

# Plot random_walk_diff
ts.plot(random_walk_diff)  
```

## Simulate the random walk model with a drift

```{r}
# Generate a RW model with a drift uing arima.sim
rw_drift <- arima.sim(model = list(order = c(0, 1, 0)), n = 100, mean = 1)

# Plot rw_drift
ts.plot(rw_drift)

# Calculate the first difference series
rw_drift_diff <- diff(rw_drift)

# Plot rw_drift_diff
ts.plot(rw_drift_diff)
```

Once again, taking the first difference of your random walk data transformed it back into white noise data, regardless of the presence of your long-term drift.

## Estimate the random walk model

```{r, echo=FALSE}
random_walk <- structure(c(0, 0.840799690805892, 0.637459389341622, 0.757921658699468, 
0.51187422142312, 0.113766891514572, 0.278972783338605, 0.277594629974007, 
0.603058933300874, 2.91209633642732, 3.18199136208394, 2.55157314365465, 
3.26756203062092, 4.99979931564387, 7.10915802250204, 8.01070864926096, 
8.23772461506037, 8.70157227268806, 9.05126103820082, 13.3200713895243, 
12.167575412894, 11.5324303105757, 12.2601004793325, 12.5767819422196, 
12.6632633175434, 12.7256680349732, 13.1994836806694, 12.8396495033226, 
13.5061940806857, 15.4816848106994, 16.177107725103, 16.8365295156745, 
16.6163362311588, 16.1808336886557, 16.9662659934889, 16.7270308469477, 
17.6561798270108, 20.8901636724502, 20.0567603436916, 22.4168556898516, 
23.1628256130545, 22.9168361903724, 21.9326982045095, 22.65474670326, 
23.6325743016245, 24.8637728096747, 25.5358779389007, 27.2225699268809, 
27.3721605280673, 29.0197579376152, 30.86984194858, 32.4859913444825, 
33.1883373188887, 33.7998279266371, 32.7718376006665, 33.3293449130956, 
36.0168049817462, 36.4458500836042, 38.2388466589622, 39.1157216648363, 
38.7992108420878, 39.2275167845668, 37.5690113188738, 40.0882062820111, 
40.5380768982454, 40.757863652738, 41.5757014101746, 41.1067983652453, 
41.1064560275605, 40.645532029424, 39.5554850868954, 40.4312197530977, 
41.9604182429803, 43.6866496098288, 45.2350442037095, 45.9024581686138, 
47.540457130699, 49.0971826208823, 48.9170239101692, 48.0796342742815, 
46.7765324003763, 47.9775098038997, 46.4334192966129, 45.9453639155814, 
47.0727461261722, 47.1890042341391, 51.2925270988872, 52.1247376806133, 
51.3796798321698, 52.127045835946, 51.2230171217941, 52.6301981357515, 
52.4262448587789, 51.3564738575462, 52.2017865810857, 53.3817249795485, 
55.0244437963563, 55.9303590282021, 55.5117187960721, 58.308031867784, 
58.1183345226755), .Tsp = c(0, 100, 1), class = "ts")
```

```{r}
# Difference your random_walk data
rw_diff <- diff(random_walk)

# Plot rw_diff
ts.plot(rw_diff)

# Now fit the WN model to the differenced data
model_wn <- arima(rw_diff, order = c(0, 0, 0))

# Store the value of the estimated time trend (intercept)
int_wn <- model_wn$coef

# Plot the original random_walk data
ts.plot(random_walk)

# Use abline(0, ...) to add time trend to the figure
abline(0, int_wn, col = "red")
```

The `arima()` command correctly identified the time trend in your original random-walk data.

## Stationary Processes

Constant mean and variance across time. 

Weakly stationary:

$$
Cov[Y_t, Y_s] = Cov[Y_i,Y_j]
$$

for all $t,s,i,j$ such that $|t-s| = |i -j|$.

## Are the white noise model or the random walk model stationary?

The white noise (WN) and random walk (RW) models are very closely related. However, only the RW is always non-stationary, both with and without a drift term. This is a simulation exercise to highlight the differences.

```{r}
set.seed(61)

# Use arima.sim() to generate WN data
white_noise <- arima.sim(model = list(order = c(0, 0, 0)), n =100)

# Use cumsum() to convert your WN data to RW
random_walk <- cumsum(white_noise)
  
# Use arima.sim() to generate WN drift data
wn_drift <- arima.sim(model = list(order = c(0, 0, 0)), n =100, mean = 0.4)
  
# Use cumsum() to convert your WN drift data to RW
rw_drift <- cumsum(wn_drift)

# Plot all four data objects
plot.ts(cbind(white_noise, random_walk, wn_drift, rw_drift))
```

